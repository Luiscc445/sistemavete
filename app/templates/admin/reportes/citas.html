{% extends "base.html" %}
{% block title %}Reporte de Citas{% endblock %}

{% block page_title %}
    <i class="bi bi-calendar-check-fill me-2"></i> Reporte de Citas
{% endblock %}

{% block breadcrumb %}
<ol class="breadcrumb mb-4">
    <li class="breadcrumb-item"><a href="{{ url_for('admin.dashboard') }}">Dashboard</a></li>
    <li class="breadcrumb-item"><a href="{{ url_for('reportes.dashboard') }}">Reportes</a></li>
    <li class="breadcrumb-item active">Citas</li>
</ol>
{% endblock %}

{% block content %}
<div class="card mb-4">
    <div class="card-header"><i class="bi bi-calendar3 me-1"></i> Filtro de Fechas</div>
    <div class="card-body">
        <form method="GET" class="row g-3">
            <div class="col-md-5">
                <label class="form-label">Fecha Inicio</label>
                <input type="date" class="form-control" name="fecha_inicio" value="{{ fecha_inicio }}">
            </div>
            <div class="col-md-5">
                <label class="form-label">Fecha Fin</label>
                <input type="date" class="form-control" name="fecha_fin" value="{{ fecha_fin }}">
            </div>
            <div class="col-md-2">
                <label class="form-label">&nbsp;</label>
                <button type="submit" class="btn btn-primary w-100"><i class="bi bi-search"></i> Filtrar</button>
            </div>
        </form>
    </div>
</div>

<div class="row mb-4">
    <div class="col-md-3">
        <div class="card bg-primary text-white">
            <div class="card-body">
                <div class="small">Total Citas</div>
                <div class="h3 mb-0">{{ total_citas }}</div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card bg-success text-white">
            <div class="card-body">
                <div class="small">Ingresos Totales</div>
                <div class="h3 mb-0">{{ ingresos_totales|currency }}</div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card bg-info text-white">
            <div class="card-body">
                <div class="small">Promedio Diario</div>
                <div class="h3 mb-0">{{ "%.1f"|format(promedio_diario) }}</div>
            </div>
        </div>
    </div>
</div>

<div class="card mb-4">
    <div class="card-header"><i class="bi bi-pie-chart me-1"></i> Citas por Estado</div>
    <div class="card-body">
        <table class="table">
            <thead>
                <tr>
                    <th>Estado</th>
                    <th>Cantidad</th>
                </tr>
            </thead>
            <tbody>
                {% for estado, cantidad in por_estado %}
                <tr>
                    <td>{{ estado|title }}</td>
                    <td><strong>{{ cantidad }}</strong></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<a href="{{ url_for('reportes.dashboard') }}" class="btn btn-secondary">
    <i class="bi bi-arrow-left me-1"></i> Volver
</a>
{% endblock %}
